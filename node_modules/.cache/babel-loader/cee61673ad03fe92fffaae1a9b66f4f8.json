{"ast":null,"code":"import _toConsumableArray from \"D:/\\u524D\\u7AEF/Myzhihu/zhihu/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from 'axios';\nimport { mixin } from '../mixin';\nexport default {\n  name: 'InfiniteScroll',\n  data: function data() {\n    return {\n      story: {},\n      date: '',\n      loading: false\n    };\n  },\n  mixins: [mixin],\n  methods: {\n    loadMore: function loadMore() {\n      var _this = this;\n\n      this.loading = true; //  this.$nextTick(()=>{\n\n      this.date.setDate(this.date.getDate() - 1);\n      var dateNow = this.date.getFullYear().toString() + (this.date.getMonth() < 10 ? '0' : '') + (this.date.getMonth() + 1).toString() + (this.date.getDate() < 10 ? '0' : '') + this.date.getDate().toString(); // console.log(dateNow);\n\n      axios.get('api/4/news/before/' + dateNow).then(function (response) {\n        var _this$story;\n\n        var s = response.data.stories;\n\n        (_this$story = _this.story).push.apply(_this$story, _toConsumableArray(s)); // console.log(s);\n\n\n        _this.loading = false;\n      }).catch(function (error) {\n        console.log(error);\n      }); // setTimeout(()=>{\n      //     console.log(111);\n      //     this.loading = false;\n      // },1000)\n      //  })\n    }\n  },\n  created: function created() {\n    var _this2 = this;\n\n    axios.get('api/4/news/latest1').then(function (response) {\n      _this2.story = response.data.stories;\n      _this2.date = new Date(); // console.log(new Date());\n      // console.log(this.story);\n    }).catch(function (error) {// console.log(error)\n    }); // console.log(this.story);\n  },\n  beforeDestroy: function beforeDestroy() {\n    console.log('InfiniteScroll will be destroied');\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;AAkBA;AACA;AACA;EACAA,sBADA;EAEAC,IAFA,kBAEA;IACA;MACAC,SADA;MAEAC,QAFA;MAGAC;IAHA;EAKA,CARA;EASAC,eATA;EAUAC;IACAC,QADA,sBACA;MAAA;;MACA,oBADA,CAEA;;MACA;MACA,4FACA,qCADA,IACA,mCADA,IAEA,8BAFA,CAJA,CAOA;;MACAC;QAAA;;QACA;;QACA,2EAFA,CAGA;;;QACA;MACA,CALA,EAMAC,KANA,CAMA;QACAC;MACA,CARA,EARA,CAiBA;MACA;MACA;MACA;MACA;IAEA;EAxBA,CAVA;EAoCAC,OApCA,qBAoCA;IAAA;;IAEAH;MACA;MACA,yBAFA,CAGA;MACA;IACA,CALA,EAMAC,KANA,CAMA,kBACA;IACA,CARA,EAFA,CAWA;EACA,CAhDA;EAiDAG,aAjDA,2BAiDA;IACAF;EACA;AAnDA","names":["name","data","story","date","loading","mixins","methods","loadMore","axios","catch","console","created","beforeDestroy"],"sourceRoot":"src/components","sources":["InfiniteScroll.vue"],"sourcesContent":["<template>\r\n        <ul\r\n        v-infinite-scroll=\"loadMore\"\r\n        :infinite-scroll-disabled=\"loading\"\r\n        infinite-scroll-immediate-check=\"false\"\r\n        infinite-scroll-distance=\"10\">\r\n            <li v-for=\"item in story\" :key=\"item.id\" @click=\"viewDetail(item.id)\">\r\n            <div class=\"msg\">\r\n                <div class=\"story_title\">{{item.title}}</div>\r\n                <div class=\"story_hint\">{{item.hint}}</div>\r\n            </div>\r\n            <img :src=\"item.images[0]\" alt=\"\">\r\n            </li>\r\n        </ul> \r\n\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport {mixin} from '../mixin'\r\nexport default {\r\n    name:'InfiniteScroll',\r\n    data () {\r\n        return {\r\n            story:{},\r\n            date:'',\r\n            loading:false\r\n        }\r\n    },\r\n    mixins:[mixin],\r\n    methods: {\r\n        loadMore() {\r\n            this.loading = true;\r\n            //  this.$nextTick(()=>{\r\n                this.date.setDate(this.date.getDate() - 1)\r\n                let dateNow =  this.date.getFullYear().toString() + (this.date.getMonth()<10 ? '0' : '')+\r\n                (this.date.getMonth()+1).toString() + (this.date.getDate()<10 ? '0' : '')+\r\n                this.date.getDate().toString()\r\n                // console.log(dateNow);\r\n                axios.get('api/4/news/before/'+dateNow).then(response => {\r\n                let s = response.data.stories\r\n                this.story.push(...s)\r\n                // console.log(s);\r\n                this.loading = false;\r\n                })\r\n                .catch(error => {\r\n                    console.log(error)\r\n                })\r\n                // setTimeout(()=>{\r\n                //     console.log(111);\r\n                //     this.loading = false;\r\n                // },1000)\r\n            //  })\r\n\r\n            }\r\n    },\r\n    created() {\r\n        \r\n        axios.get('api/4/news/latest1').then(response => {\r\n            this.story = response.data.stories\r\n            this.date = new Date()\r\n            // console.log(new Date());\r\n            // console.log(this.story);\r\n        })\r\n        .catch(error => {\r\n            // console.log(error)\r\n        })\r\n        // console.log(this.story);\r\n    },\r\n    beforeDestroy() {\r\n        console.log('InfiniteScroll will be destroied')\r\n    },\r\n}\r\n</script>\r\n<style scoped lang=\"less\">\r\n\r\nul{\r\n    // overflow-x: hidden;\r\n    li{\r\n        width: 100%;\r\n        height: 1rem;\r\n        font-size: 0.2rem;\r\n        display: flex;\r\n\r\n        .msg{\r\n\r\n            width: 2.74rem;\r\n            height: 1rem;\r\n            .story_title{\r\n                font-size: 0.16rem;\r\n                line-height: 0.16rem;\r\n                margin: 0.1rem;\r\n                margin-top: 0.2rem;\r\n            }\r\n            .story_hint{\r\n                margin-top: 0.2rem;\r\n                margin-left: 0.1rem;\r\n                font-size: 0.12rem;\r\n                line-height: 0.12rem;\r\n                color: rgb(96, 94, 94);\r\n            }\r\n        }\r\n        img{\r\n            width: 0.7rem;\r\n            height: 0.7rem;\r\n            margin:0.16rem;\r\n        }\r\n    }    \r\n}\r\n\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}